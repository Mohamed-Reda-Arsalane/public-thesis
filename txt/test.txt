[{'code': 'Attribute VB_Name = "Tabelle4"\r\nAttribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n'}
 {'code': 'Attribute VB_Name = "DieseArbeitsmappe"\r\nAttribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n\r\nPrivate Sub workbook_open()\r\n\r\n\'Option Explicit\r\n\r\n\r\n\r\n\r\nApplication.DisplayAlerts = False\r\n\r\n  If Application.Workbooks.Count > 1 Then\r\n  \r\n  Dim objExcel\r\n    Set objExcel = CreateObject("Excel.Application")\r\n    objExcel.Visible = True\r\n    Set objWorkbook = objExcel.Workbooks.Open(Filename:=ThisWorkbook.Path & "\\fif_app.xlsm", ReadOnly:=True)\r\n   \r\n    \r\n\r\n    ThisWorkbook.Close SaveChanges:=False\r\n        ThisWorkbook.Close\r\n        objExcel.Quit\r\n        \r\n     \'damit die neue Instanz den Fokus hat, funktioniert nicht...\r\n\'Application.SendKeys ("%{TAB}")\r\n  \r\n  Else\r\nGoTo NormalStarten\r\n\r\n    End If\r\n\r\nNormalStarten:\r\n\r\nApplication.Run "Schaltflche1_Klicken"\r\n\r\n\r\nEnd Sub\r\n\r\n\r\n'}
 {'code': 'Attribute VB_Name = "Tabelle8"\r\nAttribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n'}
 {'code': 'Attribute VB_Name = "Tabelle2"\r\nAttribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n'}
 {'code': 'Attribute VB_Name = "Tabelle5"\r\nAttribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n'}
 {'code': 'Attribute VB_Name = "Tabelle11"\r\nAttribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = True\r\n'}
 {'code': 'Attribute VB_Name = "UserForm1"\r\nAttribute VB_Base = "0{75515522-DA12-488C-A7D0-27386B425542}{9811CCC4-2053-4027-874A-AD839899C5E5}"\r\nAttribute VB_GlobalNameSpace = False\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = False\r\nAttribute VB_TemplateDerived = False\r\nAttribute VB_Customizable = False\r\n\r\n\'Option Explicit\r\n\r\n\'API functions\r\n#If VBA7 Then\r\n\r\n    #If Win64 Then\r\n        Private Declare PtrSafe Function GetWindowLongPtr Lib "user32" Alias "GetWindowLongPtrA" _\r\n            (ByVal hwnd As LongPtr, _\r\n             ByVal nIndex As Long _\r\n            ) As LongPtr\r\n    #Else\r\n        Private Declare PtrSafe Function GetWindowLongPtr Lib "user32" Alias "GetWindowLongA" _\r\n            (ByVal hwnd As LongPtr, _\r\n             ByVal nIndex As Long _\r\n            ) As LongPtr\r\n    #End If\r\n\r\n    #If Win64 Then\r\n        Private Declare PtrSafe Function SetWindowLongPtr Lib "user32" Alias "SetWindowLongPtrA" _\r\n            (ByVal hwnd As LongPtr, _\r\n             ByVal nIndex As Long, _\r\n             ByVal dwNewLong As LongPtr _\r\n            ) As LongPtr\r\n    #Else\r\n        Private Declare PtrSafe Function SetWindowLongPtr Lib "user32" Alias "SetWindowLongA" _\r\n            (ByVal hwnd As LongPtr, _\r\n             ByVal nIndex As Long, _\r\n             ByVal dwNewLong As LongPtr _\r\n            ) As LongPtr\r\n    #End If\r\n\r\n    Private Declare PtrSafe Function SetWindowPos Lib "user32" _\r\n        (ByVal hwnd As LongPtr, _\r\n         ByVal hWndInsertAfter As LongPtr, _\r\n         ByVal X As Long, ByVal Y As Long, _\r\n         ByVal cx As Long, ByVal cy As Long, _\r\n         ByVal wFlags As Long _\r\n        ) As LongPtr\r\n    Private Declare PtrSafe Function FindWindow Lib "user32" Alias "FindWindowA" _\r\n        (ByVal lpClassName As String, _\r\n         ByVal lpWindowName As String _\r\n        ) As LongPtr\r\n    Private Declare PtrSafe Function GetActiveWindow Lib "user32.dll" () As Long\r\n    Private Declare PtrSafe Function SendMessage Lib "user32" Alias "SendMessageA" _\r\n        (ByVal hwnd As LongPtr, _\r\n         ByVal wMsg As Long, _\r\n         ByVal wParam As Long, _\r\n         lParam As Any _\r\n        ) As LongPtr\r\n    Private Declare PtrSafe Function DrawMenuBar Lib "user32" _\r\n        (ByVal hwnd As LongPtr) As LongPtr\r\n        \r\n        Private Declare PtrSafe Function ExtractIcon _\r\n        Lib "Shell32.dll" Alias "ExtractIconA" _\r\n       (ByVal hInst As LongPtr, _\r\n        ByVal lpszExeFileName As String, _\r\n        ByVal nIconIndex As Long) As LongPtr\r\n\r\n\r\n#Else\r\n\r\n    Private Declare Function GetWindowLongPtr Lib "user32" Alias "GetWindowLongA" _\r\n        (ByVal hwnd As Long, _\r\n         ByVal nIndex As Long _\r\n        ) As Long\r\n    Private Declare Function SetWindowLongPtr Lib "user32" Alias "SetWindowLongA" _\r\n        (ByVal hwnd As Long, _\r\n         ByVal nIndex As Long, _\r\n         ByVal dwNewLong As Long _\r\n        ) As Long\r\n    Private Declare Function SetWindowPos Lib "user32" _\r\n        (ByVal hwnd As Long, _\r\n         ByVal hWndInsertAfter As Long, _\r\n         ByVal X As Long, ByVal Y As Long, _\r\n         ByVal cx As Long, ByVal cy As Long, _\r\n         ByVal wFlags As Long _\r\n        ) As Long\r\n    Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" _\r\n        (ByVal lpClassName As String, _\r\n         ByVal lpWindowName As String _\r\n        ) As Long\r\n    Private Declare Function GetActiveWindow Lib "user32.dll" () As Long\r\n    Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" _\r\n        (ByVal hwnd As Long, _\r\n         ByVal wMsg As Long, _\r\n         ByVal wParam As Long, _\r\n         lParam As Any _\r\n        ) As Long\r\n    Private Declare Function DrawMenuBar Lib "user32" _\r\n        (ByVal hwnd As Long) As Long\r\n\r\n    Private Declare Function ExtractIcon _\r\n        Lib "Shell32.dll" Alias "ExtractIconA" _\r\n       (ByVal hInst As Long, _\r\n        ByVal lpszExeFileName As String, _\r\n        ByVal nIconIndex As Long) As Long\r\n    \r\n#End If\r\n\r\n\r\n\'Constants\r\nPrivate Const SWP_NOMOVE = &H2\r\nPrivate Const SWP_NOSIZE = &H1\r\nPrivate Const GWL_EXSTYLE = (-20)\r\nPrivate Const HWND_TOP = 0\r\nPrivate Const SWP_NOACTIVATE = &H10\r\nPrivate Const SWP_HIDEWINDOW = &H80\r\nPrivate Const SWP_SHOWWINDOW = &H40\r\nPrivate Const WS_EX_APPWINDOW = &H40000\r\nPrivate Const GWL_STYLE = (-16)\r\nPrivate Const WS_THICKFRAME As Long = &H40000\r\nPrivate Const WS_MINIMIZEBOX = &H20000\r\nPrivate Const WS_MAXIMIZEBOX = &H10000\r\nPrivate Const SWP_FRAMECHANGED = &H20\r\nPrivate Const WM_SETICON = &H80\r\nPrivate Const ICON_SMALL = 0&\r\nPrivate Const ICON_BIG = 1&\r\n\r\n\r\n\'AUSBAU 32\r\n\r\n\'Dim objDieseUF As New clsUFFirmendaten\r\n\r\n  Function FileInUse(sFileName As String) As Boolean\r\n    \'ug-funktion, ob das File bereits offen ist\r\n    \r\n        \r\n    On Error Resume Next\r\n    Open sFileName For Binary Access Read Lock Read As #1\r\n    Close #1\r\n    FileInUse = IIf(Err.Number > 0, True, False)\r\n    On Error GoTo 0\r\n    \r\n    End Function\r\n\r\n  \r\n\r\n\r\nPrivate Sub sprache_umstellen()\r\n\r\nug_aktuelle_id = TextBox10.Value\r\n\r\nLabel15.Caption = TextBox10.Value\r\n\r\n\r\n\r\nIf Worksheets("db").Range("o9") = "EN" Then\r\nWorksheets("db").Range("o9") = "DE"\r\n\r\nElse\r\nWorksheets("db").Range("o9") = "EN"\r\n\r\nEnd If\r\n\r\nsprache_einstellen\r\nTextBox12.Value = Label15.Caption\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub sprache_einstellen()\r\n\r\n\r\n\'CommandButton2.Caption = Worksheets("lang").Range("n2")\r\n\'CommandButton7.Caption = Worksheets("lang").Range("n3")\r\n\'CommandButton8.Caption = Worksheets("lang").Range("n4")\r\n\'CommandButton6.Caption = Worksheets("lang").Range("n5")\r\n\'CommandButton24.Caption = Worksheets("lang").Range("n12")\r\n\'UserForm3.CommandButton6.Caption = Worksheets("lang").Range("n5")\r\n\r\n\r\n\'Frame1.Caption = Worksheets("lang").Range("n6")\r\n\'Frame2.Caption = Worksheets("lang").Range("n7")\r\n\'UserForm1.Caption = Worksheets("lang").Range("n8")\r\n\r\n\r\n\r\n\r\n\'damit die bersetzung vom aktuellen Datensatz funktioniert\r\nTextBox12.Value = ug_aktuelle_id\r\n\r\n\r\n\'machmal wird der Fokus vom Userform verloren...\r\nUserForm1.ListBox2.SetFocus\r\nUserForm1.TextBox12.SetFocus\r\n\r\n\r\nEnd Sub\r\n\r\n\r\n\r\n\r\nPrivate Sub CommandButton3_Click()\r\n\'Frame6.Visible = True\r\n\r\nEnd Sub\r\n\r\nPrivate Sub schliessen_fif_app()\r\n\r\n\'neu seit 14.10.2020: damit keine Eintrage der letzten File gemacht werden, bzw. dieses gelscht wird\r\nApplication.RecentFiles.Item(1).Delete\r\n\r\n\'damit das Userform3 wieder angezeigt wird (nur beim Entwickeln wichtig, sonst msste man es vor der Produktion manuell wegnehmen)\r\nThisWorkbook.Worksheets("pw").Range("a5") = ""\r\n\r\n\'records in db abspeichern (nur wenn aus dem Admin-Tool aktivert)\r\nIf Worksheets("pw").Range("a3").Value = True Then\r\n\r\n\r\n\r\n\'falls das records-file nicht vorhanden ist oder korrupt wurde, wird hier ein neues geschaffen\r\nDim UGsPath As String\r\nDim UGsFileName As String\r\n UGsPath = ThisWorkbook.Path\r\nUGsFileName = "\\fif_records.xlsx"\r\n \r\n \r\n  Sheets("background").Select\r\n Application.ScreenUpdating = False\r\n \r\n\'seit 6.8.19\r\nApplication.DisplayAlerts = False\r\n\r\n  \r\n  \'wenn nicht Attribut auf hidden, wird jedes Mal, auch wenn vorhanden ein neue File gemacht, bzw. das alte berschrieben...\r\nIf Dir(UGsPath & UGsFileName, vbHidden) <> "" Then\r\n    \'MsgBox "exists"\r\n    \r\n    GoTo FileVorhanden\r\n    \r\nElse\r\n    \'MsgBox "does not exist"\r\n    \r\n        Workbooks.Add\r\n        ActiveSheet.Name = "records"\r\n        ActiveWorkbook.SaveAs Filename:=UGsPath & "\\fif_records.xlsx"\r\n        \r\n        \r\n   \r\n   Workbooks("fif_app.xlsm").Sheets("records").Range("A1:F1").Copy _\r\n        Workbooks("fif_records.xlsx").Sheets("records").Range("A1:F1")\r\n        \r\n        Columns("A:F").Select\r\n    Range("F1").Activate\r\n    Selection.ColumnWidth = 27\r\n      \r\n      \r\n          Columns("b:b").Select\r\n    Selection.NumberFormat = "dd/mm/yyyy hh:mm:ss"\r\n      \r\n        Columns("F:F").Select\r\n    Selection.NumberFormat = "dd/mm/yyyy hh:mm:ss"\r\n\r\n                \r\n    Range("A1").Select\r\n        \r\n    \r\n     ActiveWorkbook.Close SaveChanges:=True\r\n      \r\n    \r\n \r\n  \r\n  Application.wait (Now + TimeValue("0:00:02"))\r\n  \r\n  \r\n  SetAttr UGsPath & UGsFileName, vbHidden\r\n  \r\n   Application.wait (Now + TimeValue("0:00:02"))\r\n   \r\n        \r\nEnd If\r\n\r\n\r\nFileVorhanden:\r\n\r\n\r\n\'vermeiden von Abstrzen wenn schliessen (seit manuell rechnen und Sheet aktualisieren...)\r\n\r\n\r\nDim ug_zeile1 As String\r\n  Dim ug_zeile2 As String\r\n  Dim ug_zeile3 As String\r\n  Dim ug_zeile4 As String\r\nDim ug_zeile5 As String\r\nDim ug_end As String\r\n\r\nug_zeile1 = "a" & Workbooks("fif_app.xlsm").Worksheets("records").Range("J1").Value\r\nug_zeile2 = "b" & Workbooks("fif_app.xlsm").Worksheets("records").Range("J1").Value\r\nug_zeile3 = "c" & Workbooks("fif_app.xlsm").Worksheets("records").Range("J1").Value\r\nug_zeile4 = "d" & Workbooks("fif_app.xlsm").Worksheets("records").Range("J1").Value\r\nug_zeile5 = "e" & Workbooks("fif_app.xlsm").Worksheets("records").Range("J1").Value\r\n\r\nWorkbooks("fif_app.xlsm").Worksheets("records").Range(ug_zeile1) = VBA.Environ("Username")\r\nWorkbooks("fif_app.xlsm").Worksheets("records").Range(ug_zeile2) = Now\r\nWorkbooks("fif_app.xlsm").Worksheets("records").Range(ug_zeile3) = TextBox12.Value\r\n\r\nWorkbooks("fif_app.xlsm").Worksheets("records").Range(ug_zeile4) = "close"\r\nWorkbooks("fif_app.xlsm").Worksheets("records").Range(ug_zeile5) = TextBox10.Value\r\n\r\n\'damit (vor allem beim Entwickeln beim Aufstarten wieder die Evaluation-Box kommt)\r\nThisWorkbook.Worksheets("pw").Range("a5") = ""\r\n\r\n  \'session day_time wird hinzugefgt\r\n       \'weil des ohne nicht geklappt hat...\r\n     Sheets("records").Visible = True\r\n    \r\n    \r\n  Worksheets("records").Select\r\n  \r\n    ug_end = Workbooks("fif_app.xlsm").Worksheets("records").Range("J1").Value - 1\r\n    Worksheets("records").Range("f2").Select\r\n    ActiveCell.FormulaR1C1 = "=R1C11"\r\n    \r\n        \r\n        \'hier jetzt immer Debugger, wenn mit x oder mit esc geschlossen wird, hier darum der workaround\r\n        If ug_end = 2 Then\r\n         \r\n         ActiveSheet.Range("f2:f2").AutoFill Destination:=Range("f2:f3"), Type:=xlFillDefault\r\n         \'Workbooks("fif_app.xlsm").Worksheets("records").Range("f2:f2").AutoFill Destination:=Range("f2:f3"), Type:=xlFillDefault\r\n       \r\n    Else\r\n           ActiveSheet.Range("f2:f2").AutoFill Destination:=Range("f2:f" & ug_end), Type:=xlFillDefault\r\n         \' Workbooks("fif_app.xlsm").Worksheets("records").ActiveSheet.Range("f2:f2").AutoFill Destination:=Range("f2:f" & ug_end), Type:=xlFillDefault\r\n                     \r\n    End If\r\n    \r\n \r\n Sheets("records").Visible = xlVeryHidden\r\n\r\n\r\n\'alter Ort: nur wenn records abspeichern gleich true\r\n\r\n\r\nDim sPath As String\r\n  Dim sFileName As String\r\n\r\n          \r\n   sPath = ThisWorkbook.Path\r\n    sFileName = "\\fif_records.xlsx"\r\n    \r\n    \r\n    \'FileInUse ist eine zustzliche FUNKTION\r\n    \r\n    If FileInUse(sPath & sFileName) Then GoTo kein_save Else GoTo normal_save\r\n        \r\n                \r\nnormal_save:\r\n              \r\n                \r\n        Application.ScreenUpdating = False\r\n          \r\n      \r\nWorkbooks("fif_app.xlsm").Sheets("records").Range("A2:f99").Copy\r\n \r\n  \r\n    Workbooks.Open Filename:=ThisWorkbook.Path & "\\fif_records.xlsx"\r\n  \r\n    \r\n    \r\n   \'von A2 auf A1 gendert am 18.10.19 und am 2.11.20: paste alles auf einer Zeile\r\n     \'Range("A1").Select\r\n    \'Selection.End(xlDown).Select\r\n                  \'ActiveCell.Offset(1, 0).Range("A1").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\r\n        :=False, Transpose:=False\r\n        \r\n        Range("A" & Cells(Rows.Count, 1).End(xlUp).Row + 1).PasteSpecial Paste:=xlPasteValues\r\n        \r\n                \r\n    Application.CutCopyMode = False\r\n    \r\n    \r\n    Range("A2").Select\r\n    Selection.End(xlDown).Select\r\n    ActiveWindow.SmallScroll Down:=1\r\n    \r\n          \r\n    \'seit 17.7.18 hat Swisscom ein save-Problem, darum hier ein error-handler\r\n    On Error GoTo save_error_handler\r\n    ActiveWorkbook.Save\r\n    \r\n    \'auch wenn das File wegen dem Swisscom-Fehler nicht gespeichert werden knnte, wird alles schn geschlossen\r\n\r\n   \r\n    ActiveWindow.Close\r\n    \r\nsave_error_handler:\r\nkein_save:\r\n    \r\n    \r\n    \r\n    \'falls vom Admin-Tool kein Speichern der Aufzeichnungsdaten, hier weiter\r\n    Else\r\n    End If\r\n    \r\n\r\nApplication.ScreenUpdating = True\r\n\r\n      \r\n \'wenn mit x geschlossen, kommt beim erneuten Starten eine Fehlermeldung bei starten von Userform1, evtl. hilft das\r\n   Unload UserForm1\r\n   \r\n   \r\n   \r\n       \'falls Applikation versteckt ist, wieder sichbar machen\r\n   If Application.Visible = False Then Application.Visible = True\r\n\r\n  \r\n  ThisWorkbook.Saved = True\r\nApplication.Quit\r\nApplication.ActiveWindow.Close SaveChanges:=False\r\nActiveWorkbook.Close SaveChanges:=False\r\n  \r\n           \r\nExit Sub\r\n\r\nEnd Sub\r\n\r\nPrivate Sub CheckBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\r\n\r\n\'CheckBox1.Value = True\r\n\r\nIf CheckBox2.Value = False Then\r\n\r\nIf CheckBox2.Visible = True Then CheckBox2.Value = True\r\nIf CheckBox3.Visible = True Then CheckBox3.Value = True\r\nIf CheckBox4.Visible = True Then CheckBox4.Value = True\r\n\r\n\'muss gerade umgekehrt sein, da nach dem Scrip der Wert nochmals gendert wird...\r\nIf CheckBox2.Value = True Then CheckBox1.Value = False\r\n\r\nElse\r\nIf CheckBox2.Visible = True Then CheckBox2.Value = False\r\nIf CheckBox3.Visible = True Then CheckBox3.Value = False\r\nIf CheckBox4.Visible = True Then CheckBox4.Value = False\r\n\r\n\'muss gerade umgekehrt sein, da nach dem Scrip der Wert nochmals gendert wird...\r\nIf CheckBox2.Value = False Then CheckBox1.Value = True\r\n\r\n\r\n\r\nEnd If\r\n\r\n\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub Frame1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\nResetMouseOver\r\nEnd Sub\r\n\r\nPrivate Sub Frame4_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\nResetMouseOver\r\nEnd Sub\r\n\r\nPrivate Sub Label16_Click()\r\n\r\n\r\nOn Error GoTo myHandler:\r\n\r\nug_zeile1 = "a" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile2 = "b" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile3 = "c" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile4 = "d" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile5 = "e" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\n\r\nThisWorkbook.Worksheets("records").Range(ug_zeile1) = VBA.Environ("Username")\r\nThisWorkbook.Worksheets("records").Range(ug_zeile2) = Now\r\nThisWorkbook.Worksheets("records").Range(ug_zeile3) = TextBox12.Value\r\nThisWorkbook.Worksheets("records").Range(ug_zeile5) = TextBox10.Value\r\nThisWorkbook.Worksheets("records").Range(ug_zeile4) = "Link " & Label16.Caption\r\n\r\n\r\n\r\n\'wenn ein Excel-File, dann wird eine neue Instanz geffnet\r\n  If InStr(1, ThisWorkbook.Worksheets("search_results").Range("L7").Value, ".xls", 1) > 0 Then\r\n  \r\n                       \r\n\r\nDim PathFile As String\r\nDim wb As String\r\n\r\n\'Create variable to instantiate a new Excel instance\r\n    Dim xl As New Excel.Application\r\n    \r\nPathFile = ThisWorkbook.Worksheets("search_results").Range("n7").Value\r\n\r\n\r\n  \r\n    xl.Workbooks.Open PathFile\r\n    \r\n    xl.Visible = True\r\n\r\n\'Discard the object variable and unhide from user\r\n    Set xl = Nothing\r\n\r\n\r\nElse\r\n\'wenn kein Excel-File normal den Link ffnen\r\nThisWorkbook.FollowHyperlink ThisWorkbook.Worksheets("search_results").Range("n7").Value\r\n\r\nEnd If\r\n\r\n\r\nExit Sub\r\n\r\n\r\nmyHandler:\r\n\'MsgBox "EROOR !"\r\n\r\nErr.Clear\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label18_Click()\r\nCreateMail\r\n\r\n\r\n\r\nEnd Sub\r\nPrivate Sub ResetMouseOver()\r\n\r\n\r\n\'If Label18.BackColor <> RGB(241, 241, 241) Then Label18.BackColor = RGB(241, 241, 241)\r\n\'If Label18.ForeColor <> RGB(69, 69, 69) Then Label18.ForeColor = RGB(69, 69, 69)\r\nIf Label18.Font.Underline = True Then Label18.Font.Underline = False\r\n\r\n\r\n\'If Label37.BackColor <> RGB(241, 241, 241) Then Label37.BackColor = RGB(241, 241, 241)\r\n\'If Label37.ForeColor <> RGB(69, 69, 69) Then Label37.ForeColor = RGB(69, 69, 69)\r\nIf Label37.Font.Underline = True Then Label37.Font.Underline = False\r\n\r\n\r\n\'If Label20.BackColor <> RGB(241, 241, 241) Then Label20.BackColor = RGB(241, 241, 241)\r\n\'If Label20.ForeColor <> RGB(69, 69, 69) Then Label20.ForeColor = RGB(69, 69, 69)\r\nIf Label20.Font.Underline = True Then Label20.Font.Underline = False\r\n\r\n\'Button oben rechts\r\n\'If Label26.BackColor <> RGB(142, 188, 249) Then Label26.BackColor = RGB(142, 188, 249) \'hellblau\r\nIf Label26.ForeColor <> RGB(41, 84, 163) Then Label26.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\'If Label27.BackColor <> RGB(142, 188, 249) Then Label27.BackColor = RGB(142, 188, 249) \'hellblau\r\n\'If Label27.ForeColor <> RGB(0, 0, 0) Then Label27.ForeColor = RGB(0, 0, 0) \'dunkelblau\r\nIf Label27.ForeColor <> RGB(41, 84, 163) Then Label27.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\'If Label28.BackColor <> RGB(142, 188, 249) Then Label28.BackColor = RGB(142, 188, 249) \'hellblau\r\n\'If Label28.ForeColor <> RGB(0, 0, 0) Then Label28.ForeColor = RGB(0, 0, 0) \'dunkelblau\r\nIf Label28.ForeColor <> RGB(41, 84, 163) Then Label28.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\'If Label29.BackColor <> RGB(142, 188, 249) Then Label29.BackColor = RGB(142, 188, 249) \'hellblau\r\n\'If Label29.ForeColor <> RGB(0, 0, 0) Then Label29.ForeColor = RGB(0, 0, 0) \'dunkelblau\r\nIf Label29.ForeColor <> RGB(41, 84, 163) Then Label29.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\'If Label30.BackColor <> RGB(142, 188, 249) Then Label30.BackColor = RGB(142, 188, 249) \'hellblau\r\n\'If Label30.ForeColor <> RGB(0, 0, 0) Then Label30.ForeColor = RGB(0, 0, 0) \'dunkelblau\r\nIf Label30.ForeColor <> RGB(41, 84, 163) Then Label30.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\'If Label31.BackColor <> RGB(142, 188, 249) Then Label31.BackColor = RGB(142, 188, 249) \'hellblau\r\n\'If Label31.ForeColor <> RGB(0, 0, 0) Then Label31.ForeColor = RGB(0, 0, 0) \'dunkelblau\r\nIf Label31.ForeColor <> RGB(41, 84, 163) Then Label31.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\'If Label32.BackColor <> RGB(142, 188, 249) Then Label32.BackColor = RGB(142, 188, 249) \'hellblau\r\n\'If Label32.ForeColor <> RGB(0, 0, 0) Then Label32.ForeColor = RGB(0, 0, 0) \'dunkelblau\r\nIf Label32.ForeColor <> RGB(41, 84, 163) Then Label32.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\n\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label18_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\n\'Label18.BackColor = RGB(128, 128, 128)\r\n\'Label18.ForeColor = RGB(41, 84, 163)\r\nLabel18.Font.Underline = True\r\n\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label37_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\n\'Label37.BackColor = RGB(128, 128, 128)\r\n\'Label37.ForeColor = RGB(255, 255, 255)\r\nLabel37.Font.Underline = True\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub Label20_Click()\r\nCreateMail\r\n\r\n\r\n\r\n\r\nEnd Sub\r\n\r\n\r\nPrivate Sub CreateMail()\r\n\r\nOn Error GoTo errorhandler\r\n\r\n\r\nug_zeile1 = "a" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile2 = "b" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile3 = "c" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile4 = "d" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile5 = "e" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\n\r\nThisWorkbook.Worksheets("records").Range(ug_zeile1) = VBA.Environ("Username")\r\nThisWorkbook.Worksheets("records").Range(ug_zeile2) = Now\r\nThisWorkbook.Worksheets("records").Range(ug_zeile3) = TextBox12.Value\r\nThisWorkbook.Worksheets("records").Range(ug_zeile5) = TextBox10.Value\r\nThisWorkbook.Worksheets("records").Range(ug_zeile4) = "email created"\r\n\r\n\'vorher: nur Inhalt in Zwischenspeicher\r\n\'damit die blaue Formatierung nicht mitgenommen wird UND keine Formel sondern Text\r\n \'ThisWorkbook.Worksheets("search_results").Range("e7").Copy\r\n\'ThisWorkbook.Worksheets("search_results").Range("e6").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\r\n        :=False, Transpose:=False\r\n   \' Application.CutCopyMode = False\r\n    \r\n\' ThisWorkbook.Worksheets("search_results").Range("e6").Copy\r\n   \r\n\r\n\r\n\r\n\r\nDim objOutlook As Object\r\nDim objMail As Object\r\nDim ug_link_name2 As String\r\nDim ug_www2 As String\r\n\r\n\'wenn kein absoluter Pfad (also NICHT ".\\"), dann muss der aktuelle Pfad mit dem relativen Pfad zusammengestellt werden (relativer Pfad ist wichtig fr die Example-Dokumente und evtl. auch fr den Kunden, wenn er den Ordner transporieren mchte\r\n\r\nDim sPath As String\r\nsPath = ThisWorkbook.Path\r\n \r\n\r\nxug_attachment1 = ThisWorkbook.Worksheets("search_results").Range("h7").Value\r\nxug_attachment2 = ThisWorkbook.Worksheets("search_results").Range("j7").Value\r\nxug_attachment3 = ThisWorkbook.Worksheets("search_results").Range("L7").Value\r\nxug_attachment4 = ThisWorkbook.Worksheets("search_results").Range("n7").Value\r\n\r\n\r\nIf InStr(1, xug_attachment1, ".\\", 1) > 0 Then ug_attachment1 = sPath & Replace(xug_attachment1, ".\\", "\\") Else ug_attachment1 = xug_attachment1\r\nIf InStr(1, xug_attachment2, ".\\", 1) > 0 Then ug_attachment2 = sPath & Replace(xug_attachment2, ".\\", "\\") Else ug_attachment2 = xug_attachment2\r\nIf InStr(1, xug_attachment3, ".\\", 1) > 0 Then ug_attachment3 = sPath & Replace(xug_attachment3, ".\\", "\\") Else ug_attachment3 = xug_attachment3\r\nIf InStr(1, xug_attachment4, ".\\", 1) > 0 Then ug_attachment4 = sPath & Replace(xug_attachment4, ".\\", "\\") Else ug_attachment4 = xug_attachment4\r\n\r\n\r\nLinkname1 = ThisWorkbook.Worksheets("search_results").Range("g7").Value\r\nLinkname2 = ThisWorkbook.Worksheets("search_results").Range("i7").Value\r\nLinkname3 = ThisWorkbook.Worksheets("search_results").Range("k7").Value\r\nLinkname4 = ThisWorkbook.Worksheets("search_results").Range("m7").Value\r\n\r\nUmbruch = "<BR>"\r\n\r\n\r\n\r\n\'fr jede Checkbox: aktiv UND http vorhanden? falls ja wir ein Text fr den Body weiter unten bereit gestellt\r\nIf CheckBox1.Value = True And InStr(1, ug_attachment1, "http", 1) > 0 Then\r\nLinktext1 = ug_attachment1\r\nLinknameText1 = Linkname1 & Umbruch\r\nElse\r\nLinktext1 = ""\r\nLinknameText1 = ""\r\nEnd If\r\n\r\nIf CheckBox2.Value = True And InStr(1, ug_attachment2, "http", 1) > 0 Then\r\nLinktext2 = ug_attachment2\r\nLinknameText2 = Linkname2 & Umbruch\r\nElse\r\nLinktext2 = ""\r\nLinknameText2 = ""\r\nEnd If\r\n\r\nIf CheckBox3.Value = True And InStr(1, ug_attachment3, "http", 1) > 0 Then\r\nLinktext3 = ug_attachment3\r\nLinknameText3 = Linkname3 & Umbruch\r\nElse\r\nLinktext3 = ""\r\nLinknameText3 = ""\r\nEnd If\r\n\r\nIf CheckBox4.Value = True And InStr(1, ug_attachment4, "http", 1) > 0 Then\r\nLinktext4 = ug_attachment4\r\nLinknameText4 = Linkname4 & Umbruch\r\nElse\r\nLinktext4 = ""\r\nLinknameText4 = ""\r\nEnd If\r\n\r\n\r\n\r\nSet objOutlook = CreateObject("Outlook.Application")\r\nSet objMail = objOutlook.CreateItem(0)\r\n\r\nug_subject = TextBox7.Value\r\nug_body = TextBox2.Value\r\n\r\n\'damit die Umbrche auch bei html kommen\r\nug_body = Replace(ug_body, vbCrLf, "<BR>")\r\n\r\n\r\n\r\nWith objMail\r\n   \'.To = ug_address\r\n   .Subject = ug_subject\r\n  \r\n   \r\n  \' If CheckBox1.Value = True And InStr(1, ug_attachment1, "http", 1) > 0 Then .Body = ug_body & ug_attachment1 Else\r\n  \' .Body = ug_body\r\n  \r\n           \r\n  \' If CheckBox2.Value = True And InStr(1, ug_attachment2, "http", 1) > 0 Then .HTMLBody = "<a href=\'" & strFileName & "\'>Hier klicken!</a>" Else\r\n  \' .Body = ug_body\r\n   .HTMLBody = ug_body & "<BR>" & "<a href=\'" & Linktext1 & "\'>" & LinknameText1 & "</a>" & "<a href=\'" & Linktext2 & "\'>" & LinknameText2 & "</a>" & "<a href=\'" & Linktext3 & "\'>" & LinknameText3 & "</a>" & "<a href=\'" & Linktext4 & "\'>" & LinknameText4 & "</a>"\r\n   \r\n   \'.HTMLBody = ug_body & "<a href=\'" & ug_www2 & "\'>" & ug_link_name2 & "</a>"\r\n   \r\n   \r\n\'.htmlBody = "To view this file, please" & "< a href=""file://\\\\292.568.8.1\\willow4\\Documents\\reports\\quarter\\" & filename & """>Click here"< /a>\r\n   \r\n   \r\n   \r\n   \r\n   \r\n  \' If CheckBox3.Value = True And InStr(1, ug_attachment3, "http", 1) > 0 Then .Body = ug_body & ug_attachment3 Else\r\n  \' .Body = ug_body\r\n         \r\n\'   If CheckBox4.Value = True And InStr(1, ug_attachment4, "http", 1) > 0 Then .Body = ug_body & ug_attachment4 Else\r\n \'  .Body = ug_body\r\n   \r\n \r\n   \'.Attachments.Add (ug_attachment1)\r\n   \r\n   \r\n   \r\n   If CheckBox1.Value = True And Not InStr(1, ug_attachment1, "http", 1) > 0 Then .Attachments.Add (ug_attachment1)\r\n   If CheckBox2.Value = True And Not InStr(1, ug_attachment2, "http", 1) > 0 Then .Attachments.Add (ug_attachment2)\r\n   If CheckBox3.Value = True And Not InStr(1, ug_attachment3, "http", 1) > 0 Then .Attachments.Add (ug_attachment3)\r\n   If CheckBox4.Value = True And Not InStr(1, ug_attachment4, "http", 1) > 0 Then .Attachments.Add (ug_attachment4)\r\n   .Display\r\n    \r\n   \'.send (wird von den Einstellungen nicht ohne Bewillungsfreigabe erlaubt, also somit komplizierter, als wenn von Hand verschickt)\r\nEnd With\r\n\r\n\'damit das Mail in Vordergrund gezeigt wird (seit 20.9.20 .Display nach den 4 If)\r\n   \' Call SetForegroundWindow(hform): Call BringWindowToTop(hform)\r\n\'Dim cl_Application As New C_Application\r\n \'cl_Application.Activate_Other_Application\r\n \'Application.WindowState = xlMinimized\r\n \r\n\r\nerrorhandler:\r\n\r\n\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label20_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\n\'Label20.BackColor = RGB(128, 128, 128)\r\n\'Label20.ForeColor = RGB(255, 255, 255)\r\nLabel20.Font.Underline = True\r\n\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label26_Click()\r\nUnload UserForm1\r\nEnd Sub\r\n\r\nPrivate Sub Label26_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\n\r\nResetMouseOver\r\n\'Label26.BackColor = RGB(41, 84, 163) \'dunkelblau\r\n\'Label26.ForeColor = RGB(255, 0, 0) \'rot\r\n\'Label26.ForeColor = RGB(255, 80, 80) \'heller-rot\r\n\'Label26.ForeColor = RGB(255, 255, 153) \'hellgelb\r\nLabel26.ForeColor = RGB(0, 0, 255) \'grell-blau\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label27_Click()\r\n\r\n\r\nug_zeile1 = "a" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile2 = "b" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile3 = "c" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile4 = "d" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\n\r\nThisWorkbook.Worksheets("records").Range(ug_zeile1) = VBA.Environ("Username")\r\nThisWorkbook.Worksheets("records").Range(ug_zeile2) = Now\r\nThisWorkbook.Worksheets("records").Range(ug_zeile3) = TextBox12.Value\r\nThisWorkbook.Worksheets("records").Range(ug_zeile4) = "Language Switch"\r\n\r\nThisWorkbook.Worksheets("search_results").Range("e7").Copy\r\n\r\n\r\nsprache_umstellen\r\n\r\nIf ThisWorkbook.Worksheets("info").Range("k9") = "yes" Then\r\nTextBox14.Value = ThisWorkbook.Worksheets("info").Range("h9")\r\nTextBox14.Visible = True\r\nLabel33.Visible = True\r\nElse\r\nTextBox14.Visible = False\r\nLabel33.Visible = False\r\nEnd If\r\n\r\n\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label27_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\nResetMouseOver\r\n\'Label27.BackColor = RGB(41, 84, 163) \'dunkelblau\r\n\'Label27.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\nLabel27.ForeColor = RGB(0, 0, 255) \'grell-blau\r\nEnd Sub\r\n\r\nPrivate Sub Label28_Click()\r\n\r\n\'Workbooks.Add hier kann ich das File nicht schliessen, wenn die App noch geffnet ist\r\n\'new instance of excel\r\nDim objXL\r\n    Set objXL = CreateObject("Excel.Application")\r\n    objXL.Visible = True\r\n    objXL.Workbooks.Add\r\n    \r\n    \r\n\r\n    \r\nEnd Sub\r\n\r\nPrivate Sub Label28_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\r\nResetMouseOver\r\n\'Label28.BackColor = RGB(41, 84, 163) \'dunkelblau\r\n\'Label28.ForeColor = RGB(249, 249, 429) \'weiss\r\n\'Label28.ForeColor = RGB(41, 84, 163) \'dunkelblau\r\nLabel28.ForeColor = RGB(0, 0, 255) \'grell-blau\r\nEnd Sub\r\n\r\nPrivate Sub Label29_Click()\r\n\r\n\'message to admin\r\n\r\nug_zeile1 = "a" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile2 = "b" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile3 = "c" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\nug_zeile4 = "d" & ThisWorkbook.Worksheets("records").Range("J1").Value\r\n\r\nThisWorkbook.Worksheets("records").Range(ug_zeile1) = VBA.Environ("Username")\r\nThisWorkbook.Worksheets("records").Range(ug_zeile2) = Now\r\nThisWorkbook.Worksheets("records").Range(ug_zeile3) = TextBox12.Value\r\nThisWorkbook.Worksheets("records").Range(ug_zeile4) = "message to