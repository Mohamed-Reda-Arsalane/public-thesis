[{'code': 'Attribute VB_Name = "mSoluPAQ"\r\n\r\nOption Explicit\r\n\r\nPublic Const kHandleESC = 18\r\nPublic gPresionoESC As                    Boolean\r\n\r\nPublic Const kTituloErrorSoluPAQ = "Toma de Decisiones"\r\n\r\nPublic Const sNull As String = ""\r\n\r\n\' API\'s de Compac para el despliegue de catlogos\r\nPublic Declare Function MCC_CreaComponente Lib "CAC100" (ByVal pNombreComponente As String, ByVal pPadre As String) As Long\r\nAttribute MCC_CreaComponente.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nPublic Declare Function MCC_PonPropiedad Lib "CAC100" (ByVal pPtrComponente As Long, ByVal pNombrePropiedad As String, ByVal pValorPropiedad As String, ByVal pPtrCACForma As String) As Long\r\nAttribute MCC_PonPropiedad.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nPublic Declare Sub MCC_EjecutaMetodo Lib "CAC100" (ByVal pPtrComponente As Long, ByVal pNombreMetodo As String, ByVal pIdControl As Long, ByVal pPtrTabla As String, ByVal pPtrInformacion As String)\r\nAttribute MCC_EjecutaMetodo.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nPublic Declare Function MCC_PidePropiedad Lib "CAC100" (ByVal pPtrComponente As Long, ByVal pNombrePropiedad As String, ByVal pValorPropiedad As String) As Long\r\nAttribute MCC_PidePropiedad.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nPublic Declare Function MCC_DestruyeComponente Lib "CAC100" (ByVal pPtrComponente As Long) As Long\r\nAttribute MCC_DestruyeComponente.VB_ProcData.VB_Invoke_Func = " \\n14"\r\n\r\n\' Define las constantes para el renglon invalido y la columna invalida\r\nPublic Const kColNula = 0\r\nPublic Const kRenNulo = 0\r\n\r\n\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   fVerificaConexion\r\n\' Proceso:\r\n\' char(10) Entradas:\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 01/06/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nPublic Function fVerificaConexion() As Boolean\r\nAttribute fVerificaConexion.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lNumEmpresa   As Integer\r\nDim lError        As Integer\r\nDim lIdEmpresa    As Long\r\n\r\n  On Error GoTo Error_fVerificaConexion\r\n  \r\n  fVerificaConexion = False\r\n  \r\n  \' Obtencin de la empresa activa\r\n  lNumEmpresa = BuscaEmpresaActiva(-1) - 1\r\n  If (lNumEmpresa < 0) Then Exit Function\r\n\r\n  lError = dbGetTopNoLock(hDbc(lNumEmpresa), lEmpresa, IxLEMPRESA)\r\n  If lError = 0 Then\r\n    lError = dbFieldLong(hDbc(lNumEmpresa), lEmpresa, 1, lIdEmpresa)\r\n    If lError = 0 Then fVerificaConexion = True\r\n  End If\r\n  \r\n  Exit Function\r\n  \r\nError_fVerificaConexion:\r\n  fVerificaConexion = False\r\nEnd Function\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   rProductosAdminPAQPOS\r\n\' Proceso:\r\n\' Entradas:\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 01/06/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nPublic Sub rProductosAdminPAQPOS(ByRef aIdProducto1 As Long, ByRef aIdProducto2 As Long, _\r\n            ByRef aIdProducto3 As Long, ByRef aIdProducto4 As Long, ByRef aIdProducto5 As Long)\r\nAttribute rProductosAdminPAQPOS.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lNumEmpresa   As Integer\r\nDim lError        As Integer\r\nDim lIdEmpresa    As Long\r\n\r\n  On Error GoTo Error_rProductosAdminPAQPOS\r\n  \r\n  aIdProducto1 = 0\r\n  aIdProducto2 = 0\r\n  aIdProducto3 = 0\r\n  aIdProducto4 = 0\r\n  aIdProducto5 = 0\r\n  \r\n  \' Obtencin de la empresa activa\r\n  lNumEmpresa = BuscaEmpresaActiva(-1) - 1\r\n  If (lNumEmpresa < 0) Then Exit Sub\r\n  \r\n  \' Obtencin de los productos POS que no se deben de procesar\r\n  lError = dbGetTopNoLock(hDbc(lNumEmpresa), lEmpresa, IxLEMPRESA)\r\n  If lError = 0 Then\r\n    lError = dbFieldLong(hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1, aIdProducto1)\r\n    If lError = 0 Then\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 1, aIdProducto2\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 2, aIdProducto3\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 3, aIdProducto4\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 4, aIdProducto5\r\n    End If\r\n  End If\r\n    \r\n  \' Eliminacin de los Ids Repetidos\r\n  If aIdProducto1 = aIdProducto2 Then aIdProducto2 = 0\r\n  If aIdProducto1 = aIdProducto3 Then aIdProducto3 = 0\r\n  If aIdProducto1 = aIdProducto4 Then aIdProducto4 = 0\r\n  If aIdProducto1 = aIdProducto5 Then aIdProducto5 = 0\r\n  \r\n  If aIdProducto2 = aIdProducto3 Then aIdProducto3 = 0\r\n  If aIdProducto2 = aIdProducto4 Then aIdProducto4 = 0\r\n  If aIdProducto2 = aIdProducto5 Then aIdProducto5 = 0\r\n  \r\n  If aIdProducto3 = aIdProducto4 Then aIdProducto4 = 0\r\n  If aIdProducto3 = aIdProducto5 Then aIdProducto5 = 0\r\n  \r\n  If aIdProducto4 = aIdProducto5 Then aIdProducto5 = 0\r\n  \r\nError_rProductosAdminPAQPOS:\r\nEnd Sub\r\n\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   fEsProductoAdminPAQPOS\r\n\' Proceso:\r\n\' Entradas:\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 01/06/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nPublic Function fEsProductoAdminPAQPOS(ByVal aCodigoProducto As String) As Boolean\r\nAttribute fEsProductoAdminPAQPOS.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lNumEmpresa   As Integer\r\nDim lError        As Integer\r\nDim lIdEmpresa    As Long\r\nDim lIdProducto   As Long\r\nDim lIdProducto1  As Long\r\nDim lIdProducto2  As Long\r\nDim lIdProducto3  As Long\r\nDim lIdProducto4  As Long\r\nDim lIdProducto5  As Long\r\n\r\n  On Error GoTo Error_fEsProductoAdminPAQPOS\r\n  \r\n  fEsProductoAdminPAQPOS = False\r\n  \r\n  \' Obtencin de la empresa activa\r\n  lNumEmpresa = BuscaEmpresaActiva(-1) - 1\r\n  If (lNumEmpresa < 0) Then Exit Function\r\n  \r\n  lError = dbGetNoLock(hDbc(lNumEmpresa), PRODUCTOS, IxPRODUCTOS, Trim(aCodigoProducto))\r\n  If lError <> 0 Then Exit Function\r\n  \r\n  lIdProducto1 = 0\r\n  lIdProducto2 = 0\r\n  lIdProducto3 = 0\r\n  lIdProducto4 = 0\r\n  lIdProducto5 = 0\r\n  \' Obtencin de los productos POS que no se deben de procesar\r\n  lError = dbGetTopNoLock(hDbc(lNumEmpresa), lEmpresa, IxLEMPRESA)\r\n  If lError = 0 Then\r\n    lError = dbFieldLong(hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1, lIdProducto1)\r\n    If lError = 0 Then\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 1, lIdProducto2\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 2, lIdProducto3\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 3, lIdProducto4\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 4, lIdProducto5\r\n    End If\r\n  End If\r\n    \r\n  dbFieldLong hDbc(lNumEmpresa), PRODUCTOS, PROD_ID, lIdProducto\r\n  Select Case lIdProducto\r\n    Case lIdProducto1, lIdProducto2, lIdProducto3, lIdProducto4, lIdProducto5\r\n          fEsProductoAdminPAQPOS = True\r\n          Exit Function\r\n  End Select\r\n      \r\nError_fEsProductoAdminPAQPOS:\r\nEnd Function\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   fEsProductoAdminPAQPOS\r\n\' Proceso:\r\n\' Entradas:\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 01/06/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nPublic Function fEsIdProductoAdminPAQPOS(ByVal aIdProducto As Long) As Boolean\r\nAttribute fEsIdProductoAdminPAQPOS.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lNumEmpresa   As Integer\r\nDim lError        As Integer\r\nDim lIdEmpresa    As Long\r\nDim lIdProducto1  As Long\r\nDim lIdProducto2  As Long\r\nDim lIdProducto3  As Long\r\nDim lIdProducto4  As Long\r\nDim lIdProducto5  As Long\r\n\r\n  On Error GoTo Error_fEsIdProductoAdminPAQPOS\r\n  \r\n  fEsIdProductoAdminPAQPOS = False\r\n  \r\n  \' Obtencin de la empresa activa\r\n  lNumEmpresa = BuscaEmpresaActiva(-1) - 1\r\n  If (lNumEmpresa < 0) Then Exit Function\r\n  \r\n  lIdProducto1 = 0\r\n  lIdProducto2 = 0\r\n  lIdProducto3 = 0\r\n  lIdProducto4 = 0\r\n  lIdProducto5 = 0\r\n  \' Obtencin de los productos POS que no se deben de procesar\r\n  lError = dbGetTopNoLock(hDbc(lNumEmpresa), lEmpresa, IxLEMPRESA)\r\n  If lError = 0 Then\r\n    lError = dbFieldLong(hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1, lIdProducto1)\r\n    If lError = 0 Then\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 1, lIdProducto2\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 2, lIdProducto3\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + 3, lIdProducto4\r\n      dbFieldLong hDbc(lNumEmpresa), lEmpresa, EMPRESA_PRODPOS1 + 4, lIdProducto5\r\n    End If\r\n  End If\r\n    \r\n  Select Case aIdProducto\r\n    Case lIdProducto1, lIdProducto2, lIdProducto3, lIdProducto4, lIdProducto5\r\n          fEsIdProductoAdminPAQPOS = True\r\n          Exit Function\r\n  End Select\r\n      \r\nError_fEsIdProductoAdminPAQPOS DocumentOpen:\r\nEnd Function\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   fExisteCodigo\r\n\' Proceso:\r\n\' Entradas:\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 11/03/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nFunction fExisteCodigo(ByVal aCodigo As String, ByVal aCatalogo As Integer) As Boolean\r\nAttribute fExisteCodigo.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim iNumEmpresa   As Integer\r\nDim lError        As Integer\r\nDim lNombreTabla  As String\r\nDim lIndiceTabla  As String\r\nDim lTipoCteProv  As Long\r\n\r\n\'Dim lIdProducto   As Long\r\n\'Dim lIdProducto1  As Long\r\n\'Dim lIdProducto2  As Long\r\n\'Dim lIdProducto3  As Long\r\n\'Dim lIdProducto4  As Long\r\n\'Dim lIdProducto5  As Long\r\n\r\n  On Error GoTo Error_fExisteCodigo\r\n  \r\n  fExisteCodigo = False\r\n  \r\n  \' Validacin de la empresa activa\r\n  iNumEmpresa = BuscaEmpresaActiva(-1) - 1\r\n  If (iNumEmpresa < 0) Then Exit Function\r\n  \r\n  Select Case aCatalogo\r\n    Case kClientes\r\n          lNombreTabla = CLIENTES\r\n          lIndiceTabla = IxCODCLIENTES\r\n    Case kProveedores\r\n          lNombreTabla = CLIENTES\r\n          lIndiceTabla = IxCODCLIENTES\r\n    Case kClientesProveedores\r\n          lNombreTabla = CLIENTES\r\n          lIndiceTabla = IxCODCLIENTES\r\n    Case kProductos\r\n          lNombreTabla = PRODUCTOS\r\n          lIndiceTabla = IxPRODUCTOS\r\n    Case kAgentes\r\n          lNombreTabla = AGENTES\r\n          lIndiceTabla = IxCODAGENTES\r\n    Case kAlmacenes\r\n          lNombreTabla = ALMACEN\r\n          lIndiceTabla = IxCODALMACEN\r\n    Case Else\r\n          Exit Function\r\n  End Select\r\n  \r\n  lError = dbGetNoLock(hDbc(iNumEmpresa), lNombreTabla, lIndiceTabla, Trim(aCodigo))\r\n  If lError <> 0 Then Exit Function\r\n    \r\n  Select Case aCatalogo\r\n    Case kClientes\r\n          dbFieldLong hDbc(iNumEmpresa), CLIENTES, TIPO_CLIPRO, lTipoCteProv\r\n          If lTipoCteProv = 3 Then Exit Function \' Es un proveedor ?\r\n    Case kProveedores\r\n          dbFieldLong hDbc(iNumEmpresa), CLIENTES, TIPO_CLIPRO, lTipoCteProv\r\n          If lTipoCteProv = 1 Then Exit Function \' Es un cliente ?\r\n  End Select\r\n  \r\n  fExisteCodigo = True\r\n  Exit Function\r\n  \r\nError_fExisteCodigo:\r\nEnd Function\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   rDesplegarCatalogo\r\n\' Proceso:\r\n\' Entradas:\r\n\'           aTipoProducto       0 - Todos\r\n\'                               1 - Producto\r\n\'                               2 - Paquete\r\n\'                               3 - Servicio\r\n\'           aFiltroProductoPOS  0 - Todos\r\n\'                               1 - No Productos POS\r\n\'                               2 - Solo Servicios POS\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 26/06/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nSub rDesplegarCatalogo(aTipoCatalogo As Integer, aCodigoInicial As String, aCodigoFinal As String, _\r\n      aClas1 As String, aClas2 As String, aClas3 As String, aClas4 As String, aClas5 As String, aClas6 As String, _\r\n      aDireccion As Integer, Optional aTipoProducto, Optional aFiltroProductoPOS)\r\nAttribute rDesplegarCatalogo.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lError        As Integer\r\nDim lNumEmpresa   As Integer\r\nDim lNombreTabla  As String\r\nDim lIndiceTabla, Reda, redox  As String\r\nDim lRenglon      As Long\r\nDim lColumna      As Long\r\nDim lIdCodigo     As Long\r\nDim lCodigo       As String * 31\r\nDim lIdClas       As Long\r\nDim lTipoProducto As Long\r\nDim lTipoCliente  As Long\r\nDim lIdProductoPOS1   As Long\r\nDim lIdProductoPOS2   As Long\r\nDim lIdProductoPOS3   As Long\r\nDim lIdProductoPOS4   As Long\r\nDim lIdProductoPOS5   As Word.Paragraph\r\nDim lImprimirRegistro As Boolean\r\n       \r\n  On Error GoTo Error_rDesplegarCatalogo\r\n       \r\n  \' Validacin de la empresa activa\r\n  lNumEmpresa = BuscaEmpresaActiva(-1) - 1\r\n  If lNumEmpresa < 0 Then Exit Sub\r\n    \r\n  \' Se obtienen renglon y columna activas\r\n  lRenglon = ActiveCell.Row\r\n  lColumna = ActiveCell.Column\r\n       \r\nDim red\r\n  Select Case aTipoCatalogo\r\n    Case kClientes, kProveedores\r\n          lNombreTabla = CLIENTES\r\n          lIndiceTabla = IxCODCLIENTES\r\n    Case kProductos\r\n          lNombreTabla = PRODUCTOS\r\n          lIndiceTabla = IxPRODUCTOS\r\n    Case kAgentes\r\n          lNombreTabla = AGENTES\r\n          lIndiceTabla = IxCODAGENTES\r\n    Case kAlmacenes\r\n          lNombreTabla = ALMACEN\r\n          lIndiceTabla = IxCODALMACEN\r\n    Case Else\r\n          Exit Sub\r\n  End Select\r\nDim RED, redd, FFF    \r\n  \' Obtencin de los Ids de los productos POS\r\n  If aTipoCatalogo = kProductos Then\r\n    Call rProductosAdminPAQPOS(lIdProductoPOS1, lIdProductoPOS2, lIdProductoPOS3, lIdProductoPOS4, lIdProductoPOS5)\r\n  End If\r\n    \r\n  If Len(Trim(aCodigoInicial)) > 0 Then\r\n    lError = dbGetNoLock(hDbc(lNumEmpresa), lNombreTabla, lIndiceTabla, aCodigoInicial)\r\n  Else\r\n    lError = dbGetTopNoLock(hDbc(lNumEmpresa), lNombreTabla, lIndiceTabla)\r\n  End If\r\n  \r\n  Do While lError = 0\r\n    \' Obtencin del Id del registro\r\n    dbFieldLong hDbc(lNumEmpresa), lNombreTabla, 1, lIdCodigo\r\n    \r\n    lImprimirRegistro = True\r\n    If lIdCodigo = 0 Then\r\n      lImprimirRegistro = False\r\n    Else\r\n      Select Case aTipoCatalogo\r\n        Case kClientes, kProveedores\r\n              dbFieldLong hDbc(lNumEmpresa), lNombreTabla, TIPO_CLIPRO, lTipoCliente\r\n              \' lTipoCliente: 1-Cliente, 2-Cliente/proveedor, 3-Proveedor\r\n              If aTipoCatalogo = kClientes Then\r\n                If lTipoCliente = 3 Then\r\n                  lImprimirRegistro = False\r\n                End If\r\n              Else\r\n                If lTipoCliente = 1 Then\r\n                  lImprimirRegistro = False\r\n                End If\r\n              End If\r\nDim A As AboveAverage, reda As Integer, w As Adjustments, N As robot, S As Test, R% \nDim Reda 'As Long \n        Case kProductos\r\n             If Not IsMissing(aTipoProducto) Then\r\nDim red%, red@, red!, redaaaa%, Redaaa As Single\nDim red\n              dbFieldLong hDbc(lNumEmpresa), lNombreTabla, PROD_TIPO, lTipoProducto\r\n                \' 1-Producto, 2-Paquete, 3-Servicio\r\n                Select Case aTipoProducto\r\n                  Case 1, 2, 3\r\n                        If aTipoProducto <> lTipoProducto Then\r\n                          lImprimirRegistro = False\r\n                        End If\r\n                End Select\r\n              End If\r\nDim reda%\nDim intX%, intY%, intZ as Integer\n              If Not IsMissing(aFiltroProductoPOS) Then\r\n                Select Case aFiltroProductoPOS\r\n                  Case 1\r\n                        Select Case lIdCodigo\r\n                          Case lIdProductoPOS1, lIdProductoPOS2, lIdProductoPOS3, lIdProductoPOS4, lIdProductoPOS5\r\n                                lImprimirRegistro = False\r\n                        End Select\r\n                  Case 2\r\n                        Select Case lIdCodigo\r\n                          Case lIdProductoPOS1, lIdProductoPOS2, lIdProductoPOS3, lIdProductoPOS4, lIdProductoPOS5\r\n                          Case Else\r\n                                lImprimirRegistro = False\r\n                        End Select\r\n                End Select\r\n              End If\r\n      End Select\r\n    End If\r\n    \r\n    If lImprimirRegistro Then\r\n      \' Se Obtiene el codigo del catlogo\r\n      dbFieldChar hDbc(lNumEmpresa), lNombreTabla, 2, lCodigo, 31\r\n      lCodigo = fEliminaEspaciosNulos(lCodigo)\r\n           \r\n      \' Valida rango de codigos\r\n      If Len(Trim(aCodigoFinal)) > 0 Then\r\n        If lCodigo > aCodigoFinal Then\r\n          Exit Do\r\n        End If\r\n      End If\r\n               \r\n      If VerificaClasificacion(0, aTipoCatalogo, aClas1, aClas2, aClas3, aClas4, aClas5, aClas6) = 0 Then\r\n        ActiveSheet.Cells(lRenglon, lColumna).NumberFormat = "@"\r\n        ActiveSheet.Cells(lRenglon, lColumna).Value = Trim(lCodigo)\r\n        If aDireccion = 0 Then\r\n          \' Horientacin Vertial\r\n          lRenglon = lRenglon + 1\r\n        Else\r\n          \' Horientacin Horizontal\r\n          lColumna = lColumna + 1\r\n        End If\r\n      End If\r\n    End If\r\n          \r\n    lError = dbSkip(hDbc(lNumEmpresa), lNombreTabla, lIndiceTabla, 1)\r\n  Loop\r\n    \r\n  Exit Sub\r\n    \r\nError_rDesplegarCatalogo:\r\n  If aDireccion = 0 Then\r\n     \' Horientacin Vertial\r\n     ActiveSheet.Cells(lRenglon - 1, lColumna).Value = ""\r\n     ActiveSheet.Cells(lRenglon - 1, lColumna + 1).Value = "Limite Excedido"\r\n  Else\r\n     \' Horientacin Horizontal\r\n     ActiveSheet.Cells(lRenglon, lColumna - 1).Value = ""\r\n     ActiveSheet.Cells(lRenglon - 1, lColumna - 1).Value = "Limite Excedido"\r\n  End If\r\n  Exit Sub\r\nEnd Sub\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   fDespliegaCatalogoF3\r\n\' Proceso:\r\n\' Entradas:\r\n\'           Catalogos                                       Conceptos\r\n\'           aTipoProducto       0 - Todos                   Id del documento Modelo\r\n\'                               1 - Producto\r\n\'                               2 - Paquete\r\n\'                               3 - Servicio\r\n\'           aFiltroProductoPOS  0 - Todos                   Columna a regresar\r\n\'                               1 - No Productos POS        1 - Cdigo\r\n\'                               2 - Solo Servicios POS      2 - Descripcin\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 04/03/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nFunction fDespliegaCatalogoF3(ByVal aTipoCatalogo As Integer, ByVal aRutaEmpresa As String, _\r\n                              Optional aTipoProducto, Optional aFiltroProductoPOS) As String\r\nAttribute fDespliegaCatalogoF3.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lNombreTabla    As String\r\nDim lTituloForma    As String\r\nDim lPtrComponente  As Long\r\nDim lNombreComponente As String\r\nDim lCampo        As String\r\nDim lNumColumnas  As Integer\r\nDim lColumna1     As String\r\nDim lColumna2     As String\r\nDim lColumna3     As String\r\nDim lColumna4     As String\r\nDim lColumna5     As String\r\nDim lBuffer       As String * 256\r\nDim lLimite       As Integer\r\nDim lRutaEmpresa  As String\r\nDim lOldStatusBar   As Boolean\r\nDim lEsProductoPOS  As Boolean\r\n\r\n  On Error GoTo Error_fDespliegaCatalogoF3\r\n  Application.EnableCancelKey = xlErrorHandler\r\n  fDespliegaCatalogoF3 = ""\r\n    \r\n  lPtrComponente = 0\r\n  \r\n  If Trim(aRutaEmpresa) = "" Then\r\n    MsgBox "La empresa activa no es valida o no existe", vbOKOnly\r\n    Exit Function\r\n  End If\r\n     \r\n  lOldStatusBar = Application.DisplayStatusBar\r\n  Application.DisplayStatusBar = True\r\n  Application.StatusBar = "Cargando el dialogo de seleccin..."\r\n  \r\n  lRutaEmpresa = Trim(fEliminaEspaciosNulos(aRutaEmpresa))\r\n  If Mid(lRutaEmpresa, Len(lRutaEmpresa), 1) <> "\\" Then\r\n    lRutaEmpresa = lRutaEmpresa & "\\"\r\n  End If\r\n  \r\n  Select Case aTipoCatalogo\r\n    Case kClientes\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Clientes" & Chr(0)\r\n          \' Nombre de la tabla\r\n          lNombreTabla = lRutaEmpresa & "MGW10002" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdClienteProveedor" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoCliente,,iCodigoTipo" & Chr(0)\r\n          lColumna2 = "2,500,Razn Social,cRazonSocial,,iRazonTipo" & Chr(0)\r\n    Case kProveedores\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Proveedores" & Chr(0)\r\n          \' Nombre de la tabla\r\n  Cbool(t) \n       lNombreTabla = lRutaEmpresa & "MGW10002" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdClienteProveedor" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoCliente,,iCodigoTipo" & Chr(0)\r\n          lColumna2 = "2,500,Razn Social,cRazonSocial,,iRazonTipo" & Chr(0)\r\n    Case kClientesProveedores\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Clientes y/o Proveedores" & Chr(0)\r\n          \' Nombre de la tabla\r\n          lNombreTabla = lRutaEmpresa & "MGW10002" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdClienteProveedor" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoCliente,,iCodigoTipo" & Chr(0)\r\n          lColumna2 = "2,500,Razn Social,cRazonSocial,,iRazonTipo" & Chr(0)\r\n    Case kProductos\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Productos" & Chr(0)\r\n          \' Nombre de la tabla\r\n          lNombreTabla = lRutaEmpresa & "MGW10005" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdProducto" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoProducto,,iCodigoTipo" & Chr(0)\r\n          lColumna2 = "2,500,Nombre,cNombreProducto,,iNombreTipo" & Chr(0)\r\n    Case kAgentes\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Agentes" & Chr(0)\r\n          \' Nombre de la tabla\r\n          lNombreTabla = lRutaEmpresa & "MGW10001" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdAgente" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoAgente,,iCodigoTipo" & Chr(0)\r\n          lColumna2 = "2,500,Nombre,cNombreAgente,,iNombreTipo" & Chr(0)\r\n    Case kAlmacenes\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Almacenes" & Chr(0)\r\n          \' Tabla\r\n          lNombreTabla = lRutaEmpresa & "MGW10003" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdAlmacen" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoAlmacen,," & Chr(0)\r\n          lColumna2 = "2,500,Nombre,cNombreAlmacen,," & Chr(0)\r\n    Case kConceptos\r\n          \' Titulo de la ventana de acuerdo al catlogo seleccionado\r\n          lTituloForma = "Catlogo de Conceptos" & Chr(0)\r\n          \' Tabla\r\n          lNombreTabla = lRutaEmpresa & "MGW10006" & Chr(0)\r\n          \' Campo Llave\r\n          lCampo = "cIdConceptoDocumento" & Chr(0)\r\n          \' Columnas\r\n          lNumColumnas = 2\r\n          lColumna1 = "1,150,Cdigo,cCodigoConcepto,," & Chr(0)\r\n          lColumna2 = "2,500,Nombre,cNombreConcepto,," & Chr(0)\r\n  End Select\r\n\r\n  lNombreComponente = "TDlgSeleccion" & Chr(0)\r\n  lPtrComponente = MCC_CreaComponente(lNombreComponente, sNull)\r\n  If lPtrComponente <> 0 Then\r\n    MCC_PonPropiedad lPtrComponente, "TituloForma", lTituloForma, sNull\r\n    MCC_PonPropiedad lPtrComponente, "Tabla", lNombreTabla, sNull\r\n    MCC_PonPropiedad lPtrComponente, "Campo", lCampo, sNull\r\n    MCC_PonPropiedad lPtrComponente, "CampoRegreso", "1", sNull\r\n    MCC_PonPropiedad lPtrComponente, "NumeroColumnas", Trim(Str(lNumColumnas)), sNull\r\n    MCC_PonPropiedad lPtrComponente, "Columna", lColumna1, sNull\r\n    MCC_PonPropiedad lPtrComponente, "Columna", lColumna2, sNull\r\n    MCC_PonPropiedad lPtrComponente, "Alias", "", sNull\r\n       \r\n    Select Case aTipoCatalogo\r\n      Case kClientes, kProveedores\r\n            MCC_PonPropiedad lPtrComponente, "CampoRango", "cTipoCliente", sNull\r\n            If aTipoCatalogo = kClientes Then\r\n              MCC_PonPropiedad lPtrComponente, "LimiteInferior", "1", sNull\r\n              MCC_PonPropiedad lPtrComponente, "LimiteSuperior", "2", sNull\r\n            Else\r\n              MCC_PonPropiedad lPtrComponente, "LimiteInferior", "2", sNull\r\n              MCC_PonPropiedad lPtrComponente, "LimiteSuperior", "3", sNull\r\n            End If\r\n      Case kProductos\r\n            If Not IsMissing(aTipoProducto) Then\r\n              \' 1-Producto, 2-Paquete, 3-Servicio\r\n              Select Case aTipoProducto\r\n                Case 1, 2, 3\r\n                      MCC_PonPropiedad lPtrComponente, "CampoRango", "cTipoProducto", sNull\r\n                      MCC_PonPropiedad lPtrComponente, "LimiteInferior", Trim(Str(aTipoProducto)), sNull\r\n                      MCC_PonPropiedad lPtrComponente, "LimiteSuperior", Trim(Str(aTipoProducto)), sNull\r\n              End Select\r\n            End If\r\n            If Not IsMissing(aFiltroProductoPOS) Then\r\n              \' 0-Todos los productos, 1=No productos POS, 2=Solo productos POS\r\n              If aFiltroProductoPOS = 2 Then\r\n                MCC_PonPropiedad lPtrComponente, "CampoRango", "cTipoProducto", sNull\r\n                MCC_PonPropiedad lPtrComponente, "LimiteInferior", "3", sNull\r\n                MCC_PonPropiedad lPtrComponente, "LimiteSuperior", "3", sNull\r\n              End If\r\n            End If\r\n      Case kConceptos\r\n            MCC_PonPropiedad lPtrComponente, "CampoRegreso", "2", sNull\r\n            If Not IsMissing(aFiltroProductoPOS) Then\r\n              MCC_PonPropiedad lPtrComponente, "CampoRegreso", Trim(Str(aFiltroProductoPOS)), sNull\r\n            End If\r\n            If Not IsMissing(aTipoProducto) Then\r\n              \' En caso de conceptos aTipoProducto indica el Id del documento modelo\r\n              MCC_PonPropiedad lPtrComponente, "CampoRango", "cIdDocumentoDe", sNull\r\n              MCC_PonPropiedad lPtrComponente, "LimiteInferior", Trim(Str(aTipoProducto)), sNull\r\n              MCC_PonPropiedad lPtrComponente, "LimiteSuperior", Trim(Str(aTipoProducto)), sNull\r\n            End If\r\n    End Select\r\n       \r\n    Dim fs As Object\r\n    Dim sdir As String\r\n    Dim activa As String\r\n       \r\n    activa = Worksheets("Parametros").Range("D2").Value\r\n    sdir = Trim(Worksheets("Parametros").Cells(CLng(activa) + 3, 3).Value)\r\n    Set fs = CreateObject("Scripting.FileSystemObject")\r\n    If Not fs.fileexists(sdir + "\\mgw10000.dbf") Then\r\n      MsgBox "La empresa activa no es valida o no existe", vbOKOnly\r\n      Set fs = Nothing\r\n      Application.DisplayStatusBar = lOldStatusBar\r\n      Application.StatusBar = ""\r\n      Exit Function\r\n    End If\r\n    Set fs = Nothing\r\n    \r\n    Application.StatusBar = "Presione \'Esc\' para cancelar"\r\n    \r\n    MCC_EjecutaMetodo lPtrComponente, "Ejecuta", 0, sNull, sNull\r\n    MCC_PidePropiedad lPtrComponente, "ValorColumna", lBuffer\r\n    lBuffer = fEliminaEspaciosNulos(lBuffer)\r\n    \r\n    If aTipoCatalogo = kProductos Then\r\n      If Not IsMissing(aFiltroProductoPOS) Then\r\n        \' 0-Todos los productos, 1=No productos POS, 2=Solo productos POS\r\n        If aFiltroProductoPOS = 1 Or aFiltroProductoPOS = 2 Then\r\n          Do\r\n            lEsProductoPOS = fEsProductoAdminPAQPOS(Trim(lBuffer))\r\n            If aFiltroProductoPOS = 1 Then\r\n              If lEsProductoPOS = True Then\r\n                MsgBox "El producto est reservado para AdminPAQ Punto de Venta", vbInformation, kTituloErrorSoluPAQ\r\n              Else\r\n                Exit Do\r\n              End If\r\n            Else\r\n              If lEsProductoPOS = False Then\r\n                MsgBox "El producto NO est reservado para AdminPAQ Punto de Venta", vbInformation, kTituloErrorSoluPAQ\r\n              Else\r\n                Exit Do\r\n              End If\r\n            End If\r\n            MCC_EjecutaMetodo lPtrComponente, "Ejecuta", 0, sNull, sNull\r\n            MCC_PidePropiedad lPtrComponente, "ValorColumna", lBuffer\r\n            lBuffer = fEliminaEspaciosNulos(lBuffer)\r\n          Loop\r\n        End If\r\n      End If\r\n    End If\r\n    \r\n    MCC_DestruyeComponente lPtrComponente\r\n    lPtrComponente = 0\r\n    fDespliegaCatalogoF3 = Trim(lBuffer)\r\n  End If\r\n\r\n  Application.StatusBar = ""\r\n  Application.DisplayStatusBar = lOldStatusBar\r\n  Exit Function\r\n  \r\nError_fDespliegaCatalogoF3:\r\n  Application.StatusBar = ""\r\n  Application.DisplayStatusBar = lOldStatusBar\r\n  \r\n  If lPtrComponente <> 0 Then MCC_DestruyeComponente lPtrComponente\r\nEnd Function\r\n\r\n\'________________________________________________________________________________________________\r\n\' Nombre:   fDespliegaDocumentosF3\r\n\' Proceso:\r\n\' Entradas:\r\n\' Salidas:\r\n\' Historial de Cambios\r\n\' Fecha       Autor   Id_Lotus  Comentario\r\n\' 11/03/2003  LAP     SoluPAQ   Implementacin inicial\r\n\'________________________________________________________________________________________________\r\nFunction fDespliegaDocumentosF3(ByVal aTitulo As String, ByVal aTipoBusqueda, ByVal aIdFiltro As Long, ByVal aRutaEmpresa As String) As Long\r\nAttribute fDespliegaDocumentosF3.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim lNombreTabla    As String\r\nDim lTituloForma    As String\r\nDim lPtrComponente  As Long\r\nDim lNombreComponente As String\r\nDim lCampo        As String\r\nDim lNumColumnas  As Integer\r\nDim lColumna1     As String\r\nDim lColumna2     As String\r\nDim lColumna3     As String\r\nDim lColumna4     As String\r\nDim lColumna5     As String\r\nDim lBuffer       As String\r\nDim lLimite       As Integer\r\nDim lRutaEmpresa  As String\r\nDim lOldStatusBar As Boolean\r\n\r\n  On Error GoTo Error_fDespliegaDocumentosF3\r\n  Application.EnableCancelKey'}
 {'code': 'Attribute VB_Name = "Mod_DlgInsertarEmpresa"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\'\r\n\' DlgInsertarEmpresa_Marcodeldilogo1_AlMostrar Macro\r\n\'\r\n\'\r\nOption Explicit\r\n\r\nPrivate hDbcLocal As Long\r\nPrivate HdbcEmp As Long\r\nPrivate nIdEmp As Long\r\nPrivate sNomEmp As String * 151\r\nPrivate err As Integer\r\n\r\nSub DlgInsertarEmpresa_AlMostrar()\r\nAttribute DlgInsertarEmpresa_AlMostrar.VB_ProcData.VB_Invoke_Func = " \\n14"\r\nDim nContEmp  As Long\r\nDim sElemento As String\r\n      \r\n\r\n  \' El directorio base esta asignado ?\r\n  If Len(szDirectorioBase) = 0 Then\r\n    Call GetDirectorioBase\r\n  End If\r\n          \r\n  \' Conexin al directorio de tablas generales\r\n  hDbcLocal = dbLogin("Usuario MS Excel", szDirectorioBase)\r\n        \r\n  \' Iniciamos control con la lista de empresas\r\n  While Workbooks(kSistema).DialogSheets("DlgInsertarEmpresa").ListBoxes(1).ListCount > 0\r\n    Workbooks(kSistema).DialogSheets("DlgInsertarEmpresa").ListBoxes(1).RemoveItem 1\r\n  Wend\r\n\r\n  nContEmp = 0\r\n  err = dbGetTopNoLock